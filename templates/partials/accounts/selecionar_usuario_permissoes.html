{% if perms.auth.change_permission %}
{% load static %}
{% load widget_tweaks %}

<!-- ğŸ§­ Tela: SeleÃ§Ã£o de UsuÃ¡rios para PermissÃµes -->
<div class="container my-5" style="max-width: 720px;">

  <!-- ğŸ“Œ Identificador de tela para scripts.js -->
  <div id="identificador-tela" data-tela="selecionar-usuario-permissoes"></div>

  <!-- ğŸ”– CabeÃ§alho -->
  <div class="mb-4 text-center">
    <h2 class="mb-2">Gerenciar PermissÃµes de UsuÃ¡rios</h2>
    <p class="text-muted">
      Selecione um ou mais usuÃ¡rios para editar ou excluir permissÃµes.
    </p>
  </div>

  <!-- ğŸ“‹ FormulÃ¡rio AJAX -->
  <form id="permissoes-form" method="POST" class="ajax-form">
    {% csrf_token %}

    <!-- ğŸ› ï¸ AÃ§Ãµes -->
    <div class="d-flex justify-content-between gap-2 mb-3">
      <button type="button"
              id="btn-editar"
              class="btn btn-outline-primary btn-sm"
              disabled>
        âœï¸ Editar PermissÃµes
      </button>

      <button type="submit"
              id="btn-excluir"
              class="btn btn-outline-danger btn-sm"
              formaction="{% url 'accounts:excluir_usuario_multiplo' %}"
              disabled>
        ğŸ—‘ï¸ Excluir PermissÃµes
      </button>
    </div>

    <!-- ğŸ‘¥ Lista de UsuÃ¡rios -->
    <ul class="list-group shadow-sm">
      {% for usuario in usuarios %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div class="form-check">
            <input type="checkbox"
                   class="form-check-input usuario-checkbox"
                   name="usuarios_selecionados"
                   value="{{ usuario.id }}"
                   id="usuario{{ usuario.id }}">
            <label class="form-check-label ms-2" for="usuario{{ usuario.id }}">
              {{ usuario.get_full_name|default:usuario.username }}
            </label>
          </div>
        </li>
      {% empty %}
        <li class="list-group-item text-muted text-center">
          Nenhum usuÃ¡rio encontrado.
        </li>
      {% endfor %}
    </ul>
  </form>
</div>
{% else %}
<div class="alert alert-danger text-center mt-5">
  VocÃª nÃ£o tem permissÃ£o para acessar esta funcionalidade.
</div>
{% endif %}