{% load static %}
{% load widget_tweaks %}

<!-- ğŸ§­ Tela: EdiÃ§Ã£o de PermissÃµes de UsuÃ¡rio -->
<div class="d-flex justify-content-center">
  <div class="card shadow p-4 w-100" style="max-width: 720px;">

    <!-- ğŸ“Œ Identificador de tela para diagnÃ³stico JS -->
    <div id="identificador-tela" data-tela="editar-permissoes-usuario"></div>

    <!-- ğŸ§¾ TÃ­tulo -->
    <h2 class="text-center mb-4">
      PermissÃµes de {{ usuario.get_full_name|default:usuario.username }}
    </h2>

    <!-- ğŸ“‹ FormulÃ¡rio AJAX -->
    <form method="post"
          class="ajax-form needs-validation"
          data-url="{% url 'accounts:editar_permissoes' usuario.id %}"
          novalidate>
      {% csrf_token %}

      <!-- ğŸ›¡ï¸ Campo de mÃºltipla seleÃ§Ã£o -->
      <div class="mb-3">
        <label for="permissoes" class="form-label">
          Selecione as permissÃµes atribuÃ­das ao usuÃ¡rio:
        </label>

        <select name="permissoes"
                id="permissoes"
                class="form-select"
                multiple
                required
                size="12">
          {% for perm in todas_permissoes %}
            <option value="{{ perm.id }}" {% if perm in permissoes_usuario %}selected{% endif %}>
              {{ perm.name }} â€” {{ perm.codename }}
            </option>
          {% endfor %}
        </select>

        <div class="form-text mt-1">
          Pressione <kbd>Ctrl</kbd> (Windows) ou <kbd>Cmd</kbd> (Mac) para mÃºltipla seleÃ§Ã£o.
        </div>
      </div>

      <!-- ğŸ”˜ AÃ§Ãµes -->
      <div class="d-flex justify-content-between mt-4">
        <button type="submit" class="btn btn-primary w-50 me-2">
          ğŸ’¾ Salvar PermissÃµes
        </button>
        <a href="{% url 'accounts:selecionar_usuario_permissoes' %}"
           class="btn btn-secondary w-50 ajax-link">
          â† Voltar
        </a>
      </div>
    </form>
  </div>
</div>

